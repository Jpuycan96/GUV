<mat-card class="precios-section">
  <!-- Header -->
  <mat-card-header>
    <div class="header-left">
      <mat-card-title>
        <mat-icon class="section-icon">attach_money</mat-icon>
        Precios
      </mat-card-title>
    </div>
    <div class="header-right">
      <button mat-icon-button (click)="recargar()" matTooltip="Recargar">
        <mat-icon>refresh</mat-icon>
      </button>
      <button mat-raised-button color="primary" (click)="abrirModalEscala()" matTooltip="Agregar precio por escala">
        <mat-icon>add</mat-icon>
        Precio Escala
      </button>
      <button mat-raised-button color="accent" (click)="abrirModalArea()" matTooltip="Agregar precio por área">
        <mat-icon>add</mat-icon>
        Precio Área
      </button>
    </div>
  </mat-card-header>

  <!-- Contenido -->
  <mat-card-content>
    <!-- Mensaje de error -->
    <div *ngIf="error" class="alert alert-error">
      <mat-icon>error</mat-icon>
      <span>{{ error }}</span>
    </div>

    <!-- Loading -->
    <div *ngIf="cargando" class="loading">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Cargando precios...</p>
    </div>

    <!-- Tabla de precios -->
    <div *ngIf="!cargando && preciosUnificados.length > 0" class="tabla-container">
      <table mat-table [dataSource]="preciosUnificados" class="precios-table">
        
        <!-- Columna Tipo -->
        <ng-container matColumnDef="tipo">
          <th mat-header-cell *matHeaderCellDef>Tipo</th>
          <td mat-cell *matCellDef="let precio">
            <mat-chip [color]="obtenerColorTipo(precio.tipo)" selected>
              {{ obtenerTextoTipo(precio.tipo) }}
            </mat-chip>
          </td>
        </ng-container>

        <!-- Columna Material -->
        <ng-container matColumnDef="material">
          <th mat-header-cell *matHeaderCellDef>Material</th>
          <td mat-cell *matCellDef="let precio">
            <strong>{{ precio.material }}</strong>
          </td>
        </ng-container>

        <!-- Columna Modelo -->
        <ng-container matColumnDef="modelo">
          <th mat-header-cell *matHeaderCellDef>Modelo</th>
          <td mat-cell *matCellDef="let precio">
            {{ precio.modelo || '—' }}
          </td>
        </ng-container>

        <!-- Columna Rango -->
        <ng-container matColumnDef="rango">
          <th mat-header-cell *matHeaderCellDef>Cantidad</th>
          <td mat-cell *matCellDef="let precio">
            {{ precio.rango }}
          </td>
        </ng-container>

        <!-- Columna Precio -->
        <ng-container matColumnDef="precio">
          <th mat-header-cell *matHeaderCellDef>Precio</th>
          <td mat-cell *matCellDef="let precio" class="precio-value">
            <span class="precio-amount">{{ precio.precio }}</span>
            <span class="precio-unit">/ {{ precio.unidad || 'unidad' }}</span>
          </td>
        </ng-container>

        <!-- Columna Acciones -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef>Acciones</th>
          <td mat-cell *matCellDef="let precio">
            <button mat-icon-button (click)="editarPrecio(precio)" 
                    matTooltip="Editar" color="primary">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button (click)="eliminarPrecio(precio)" 
                    matTooltip="Eliminar" color="warn">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnasTabla"></tr>
        <tr mat-row *matRowDef="let row; columns: columnasTabla;" class="precio-row"></tr>
      </table>
    </div>

    <!-- Estado vacío -->
    <div *ngIf="!cargando && preciosUnificados.length === 0" class="empty-state">
      <mat-icon class="empty-icon">inbox</mat-icon>
      <p>No hay precios configurados</p>
      <div class="empty-actions">
        <button mat-raised-button color="primary" (click)="abrirModalEscala()">
          <mat-icon>add</mat-icon>
          Crear Precio Escala
        </button>
        <button mat-raised-button color="accent" (click)="abrirModalArea()">
          <mat-icon>add</mat-icon>
          Crear Precio Área
        </button>
      </div>
    </div>
  </mat-card-content>
</mat-card>